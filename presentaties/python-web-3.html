<!doctype html>
<html>
	<head>
		<title>Web Services Python: Les 2</title>
		<link rel="stylesheet" type="text/css" href="../css/reset.css">
		<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="../highlight/styles/googlecode.css">
		<link href="https://fonts.googleapis.com/css?family=Karla:700|Open+Sans" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="../css/agnes.css">
		<link rel="stylesheet" type="text/css" href="../css/htmlgallery.css">
		<script src='https://s3-us-west-2.amazonaws.com/s.cdpn.io/194554/scroll-converter.min.js'></script>
		<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
		<script src='../highlight/highlight.pack.js'></script>
		<script src="../js/script.js" defer></script>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta charset="utf-8">
	</head>
	<body data-markdown="true">
				<section>
							# Web Services Python
							## 2/ web API's bouwen met FastAPI
							#### Kristof Michiels
				</section>
				<section>
							## Inhoud
							- Geneste models
				</section>
				<section class="chapter">
							## Geneste models
				</section>
				<section>
							## Geneste models
							
							```Python
							from fastapi import FastAPI
							from pydantic import BaseModel
							app = FastAPI()
							
							class Item(BaseModel):
								name: str
								description: str | None = None
								price: float
								tax: float | None = None
								tags: list = []

							@app.put("/items/{item_id}")
							async def update_item(item_id: int, item: Item):
								results = {"item_id": item_id, "item": item}
								return results
							```

							https://fastapi.tiangolo.com/tutorial/body-nested-models
				</section>

				<section>
							## Foutafhandeling
				</section>
				<section class="chapter">
							## Templates in FastAPI
				</section>
				<section>
							## Templates in FastAPI
							- Templating is the process of displaying the data gotten from the API in various formats
							- Templates act as a frontend component in web applications. can be used to create views and render responses from the API.
							- FastAPI kan responses weergeven geven die gebruik maken van [Jinja templates](https://jinja.palletsprojects.com/en/3.1.x/)
							- Jinja is a templating engine written in Python designed to help the rendering process of API responses
							- In every templating language, there are variables that get replaced with the actual values passed to them when the template is rendered, and there are tags that control the logic of the template.
				</section>
				<section>
							## Jinja
							- Jinja templating engine makes use of curly brackets { } to distinguish its expressions and syntax from regular HTML, text and any other variable in the template file
							- The {{ }} syntax is called a variable block. The {% %} syntax houses control structures such as if/else, loops, and macros
							- The three common syntax blocks used in the Jinja templating language include the following:
								- {% ... %} – This syntax is used for statements such as control structures.
								- {{ todo.item }} – This syntax is used to print out the values of the expressions passed to it.
								- {# This is a great API book! #} – This syntax is used when writing comments and is not displayed on the web page.
							- Jinja template variables can be of any Python type or object if they can be converted into strings. A model, list, or dictionary type can be passed to the template and have its attributes displayed by placing these attributes in the second block listed previously.
				</section>
				<section>
							## Filters

							- filters enable us to execute certain functions such as joining values from a list and retrieving the length of an object, among others.
							- A filter is separated from the variable by a pipe symbol (|) and may entertain optional arguments in parentheses. A filter is defined in this format (haakjes weglaten indien geen argumenten):

							```Python
							{{ variable | filter_name(*args) }}
							```

							- For a full list of filters and to learn more about filters in Jinja, visit
							https://jinja.palletsprojects.com/en/3.0.x/ templates/#builtin-filters.
				</section>
				<section>
							## Filters

							- The default filter variable is used to replace the output of the passed value if it turns out to be None:
							
							```Python
							{{ todo.item | default('This is a default todo item') }}
							```

							- The escape filter is used to render raw HTML output:

							```Python
							{{ "<title>Todo Application</title>" | escape }}
							```

							- The conversion filters include int and float filters used to convert from one data type to another:

							```Python
							{{ 3.142 | int }}
							```
				</section>
				<section>
							## Filters

							- The join filter / is used to join elements in a list into a string as in Python:
							
							```Python
							{{ ['Packt', 'produces', 'great', 'books!'] | join(' ') }}
							```

							- The length filter is used to return the length of the object passed. It fulfills the same role as len() in Python:

							```Python
							Todo count: {{ todos | length }}
							```
				</section>
				<section>
							## If-statements

							- The usage of if statements in Jinja is similar to their usage in Python. if statements are used in the {% %} control blocks
				
							```Python
							{% if todo | length < 5 %}
								You dont have much items on your todo list!
							{% else %}
								You have a busy day it seems!
							{% endif %}
							```
				</section>
				<section>
							## Loops

							We can also iterate through variables in Jinja. This could be a list or a general function, such as the following, for example:

							```Python
							{% for todo in todos %}
									<b> {{ todo.item }} </b>
							{% endfor %}
							```

							You can access special variables inside a for loop: https://jinja.palletsprojects.com/en/3.0.x/templates/, such as loop.index, which gives the index of the current iteration. 
							loop.index: current iteration of the loop (1 indexed); loop.index0; loop.revindex: number of iterations from the end of the loop (1 indexed) of loop.revindex0
							loop.first: true if first iteration
				</section>
				<section>
							## Macros

							- A macro in Jinja is a function that returns an HTML string. The main use case for macros is to avoid the repetition of code and instead use a single function call. For example, an input macro is defined to reduce the continuous definition of input tags in an HTML form:
				
							```Jinja
							{% macro input(name, value='', type='text', size=20 %}
								<div class="form">
								<input type="{{ type }}" name="{{ name }}" value="{{ value|escape }}" size="{{ size }}">
								</div>
							{% endmacro %}
							```
							
							```Jinja
							{{ input('item') }}
							```

				</section>
				<section>
							## Template inheritance

							- Jinja’s most powerful feature is the inheritance of templates. This feature advances the don't repeat yourself (DRY) principle and comes in handy in large web applications. Template inheritance is a situation where a base template is defined and child templates can interact, inherit, and replace defined sections of the base template.
							- You can learn more about Jinja’s template inheritance at https://jinja. palletsprojects.com/en/3.0.x/templates/#template- inheritance.
				</section>
				<section>
							## Jinja en FastAPI

							- install the Jinja package (pip install jinja2) and create a new folder, templates, in our project directory. This folder will store all our Jinja files, which are HTML files mixed with Jinja’s syntax. 
							- We’ll start by creating the homepage template, which will house the section for creating new todos.
							- home.html for the application’s home page / todo.html for the todo page
							- Before moving on to build our templates, let’s configure Jinja in our FastAPI application:
							- Let’s modify the POST route of the todo API component, todo.py:
							- Ook de GET routes gelijkaardige aanpassingen...
							In the preceding code block, we have configured Jinja to look into the templates directory to serve the templates passed to the templates. TemplateResponse() method.
The POST method for adding a todo has also been updated to include a dependency on the input passed.
In model.py, add the highlighted code before the Config subclass !!! nog niet getoond

				</section>
				<section>
							## FastAPI en Jinja

							```Python
							from fastapi.templating import Jinja2Templates

							templates = Jinja2Templates(directory="templates/")

							@todo_router.post("/todo")
							async def add_todo(request: Request, todo: Todo = Depends(Todo.as_form)):
								todo.id = len(todo_list) + 1
								todo_list.append(todo)
								return templates.TemplateResponse("todo.html",
								{
									"request": request,
									"todos": todo_list
								})
							```
				</section>
				<section>
							## Volgende les

							-  complete API that uses a database, authentication, and templates
							-  structure your application to enhance efficiency, readability, and scalability
							- connect your application to both a SQL database and a NoSQL database, integrate templates, and build authentication

				</section>
		
				<section>
							## Web Services Python - web API's bouwen met FastAPI - kristof.michiels01@ap.be
				</section>
	</body>
</html>